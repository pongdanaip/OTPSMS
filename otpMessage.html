<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
</head>
<body>
    <div class="fn-otp-input-section">
        <input type="text" id="OTP_1" name="OTP_1" class="fn-otp-input noto-l-bold txt-Reqkeynumber" inputmode="numeric" maxlength="1" data-index="0" autocomplete="off" data-next="OTP_2">
        <input type="text" id="OTP_2" name="OTP_2" class="fn-otp-input noto-l-bold txt-Reqkeynumber" inputmode="numeric" maxlength="1" data-index="1" autocomplete="off" data-next="OTP_3" data-previous="OTP_1" disabled>
        <input type="text" id="OTP_3" name="OTP_3" class="fn-otp-input noto-l-bold txt-Reqkeynumber" inputmode="numeric" maxlength="1" data-index="2" autocomplete="off" data-next="OTP_4" data-previous="OTP_2" disabled>
        <input type="text" id="OTP_4" name="OTP_4" class="fn-otp-input noto-l-bold txt-Reqkeynumber" inputmode="numeric" maxlength="1" data-index="3" autocomplete="off" data-next="OTP_5" data-previous="OTP_3" disabled>
        <input type="text" id="OTP_5" name="OTP_5" class="fn-otp-input noto-l-bold txt-Reqkeynumber" inputmode="numeric" maxlength="1" data-index="4" autocomplete="off" data-next="OTP_6" data-previous="OTP_4" disabled>
        <input type="text" id="OTP_6" name="OTP_6" class="fn-otp-input noto-l-bold txt-Reqkeynumber" inputmode="numeric" maxlength="1" data-index="5" autocomplete="off" data-previous="OTP_5" disabled>        
    </div>
    <script>
        window.onload = function () {
            document.getElementById("OTP_1").focus();
            countdownFunc();
        }

        // OTP input
        var container = document.getElementsByClassName("fn-otp-input-section")[0];
        container.onkeyup = function (e) {
            var target = e.srcElement || e.target;
            var maxLength = parseInt(target.attributes["maxlength"].value, 10);
            var myLength = target.value.length;
            if (myLength >= maxLength) {
                var next = target;
                while (next = next.nextElementSibling) {
                    if (next == null)
                        break;
                    if (next.tagName.toLowerCase() === "input") {
                        next.focus();
                        break;
                    }
                }
            }
            // Move to previous field if empty (user pressed backspace)
            else if (myLength === 0) {
                var previous = target;
                while (previous = previous.previousElementSibling) {
                    if (previous == null)
                        break;
                    if (previous.tagName.toLowerCase() === "input") {
                        previous.focus();
                        break;
                    }
                }
            }
        }

        // Countdown function
        var countdownFunc = function () {
            var count = 59, timer = setInterval(function () {
                $(".countdown").html(count--);
                if (count <= -1) {
                    clearInterval(timer);
                    $("#timeCountDown").hide();
                    $("#requestOTP").removeClass("d-none");
                    $("#expireOTP").removeClass("d-none");
                }
            }, 1000);
        }

        // request new otp
        function requestNewOTP() {
            $("#requestOTP").addClass("d-none");
            $("#expireOTP").addClass("d-none");
            $("#invalidOTP").addClass("d-none");
            $("#fn-alert-email").removeClass("d-none");
            $("#timeCountDown").show();
            $(".countdown").html("59");
            countdownFunc();
        }

        // verify otp
        function verifyOTP() {
            let otp1 = $("#OTP_1").val();
            let otp2 = $("#OTP_2").val();
            let otp3 = $("#OTP_3").val();
            let otp4 = $("#OTP_4").val();
            let otp5 = $("#OTP_5").val();
            let otp6 = $("#OTP_6").val();
            let otpValue = otp1 + otp2 + otp3 + otp4 + otp5 + otp6;
            if (otpValue == "999999") {
                $("#invalidOTP").addClass("d-none");
            } else {
                $("#invalidOTP").removeClass("d-none");
                $("#expireOTP").addClass("d-none");
            }
        }

        $(function () {
            $(".fn-otp-input-section .fn-otp-input").keypress(function (e) {
                if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                    return false;
                }
            });
        });

        $(".fn-otp-input-section .fn-otp-input").keydown(function (e) {
            if (e.which == 8) {
                if ($(this).val() == "") {
                    $(this).prev().val("");
                    $(this).prev().focus();
                }
            }
        });

        $(document).ready(function () {
            // paste otp function
            const $inp = $(".fn-otp-input");

            $inp.on({
                paste(ev) { // Handle Pasting

                    const clip = ev.originalEvent.clipboardData.getData('text').trim();
                    // Allow numbers only
                    if (!/\d{6}/.test(clip)) return ev.preventDefault(); // Invalid. Exit here
                    // Split string to Array or characters
                    const s = [...clip];
                    // Populate inputs. Focus last input.
                    $inp.val(i => s[i]).eq(5).focus();
                    $inp.removeAttr('disabled');
                },
                input(ev) { // Handle typing

                    const i = $inp.index(this);
                    if (this.value) $inp.eq(i + 1).focus();
                },
                keydown(ev) { // Handle Deleting

                    const i = $inp.index(this);
                    if (!this.value && ev.key === "Backspace" && i) $inp.eq(i - 1).focus();
                }

            });

            $(".fn-otp-input").keyup(function () {
                if ($(this).val() == "" || $(this).val() == undefined) {
                    if ($(this).next().val() == "" || $(this).next().val() == undefined) {
                        $(this).nextAll().prop("disabled", true);
                    }
                } else {
                    $(this).nextAll().removeAttr('disabled');
                }
            });

            // end paste otp function
        });
    </script>
</body>
</html>
